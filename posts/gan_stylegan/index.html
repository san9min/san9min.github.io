<!DOCTYPE html>
<html lang="ko"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Sangmin Blog | GAN : StyleGAN</title>
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
  
  <link rel="stylesheet"
     href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link rel="stylesheet" href="../../assets/styles/main.css">
  
<link rel="icon" type="image/png" href="/assets/favicon.png" sizes="32x32">
</head><body>
  <main class="article">
    <h1>GAN : StyleGAN</h1>
    <div class="meta">Sep 26, 2022 Â· 20 min read</div>
    <img class="hero" src="../..//images/gan_stylegan/thumb.webp" alt="cover image">
    <p><a href="https://arxiv.org/abs/1812.04948">A Style-Based Generator Architecture for Generative Adversarial Networks</a></p>
<blockquote>
<p><strong>GANì€ implicití•˜ê²Œ train dataì˜ distributionì„ í•™ìŠµí•œë‹¤.
GeneratorëŠ” í•™ìŠµí•œ distributionì„ ë°”íƒ•ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.</strong></p>
</blockquote>
<h3>ğŸ‘¨â€ğŸ¨ Image style transfer</h3>
<p><strong>Cycle GAN</strong></p>
<p><img src="/images/gan_stylegan/01.png" alt="Untitled"></p>
<p>X, YëŠ” Domain (ì—¬ê¸°ì„  ìŠ¤íƒ€ì¼ì •ë„ë¡œ ë³´ë©´ ë¨)</p>
<blockquote>
<p>G : X â†’ Y ; mapping function<br>F : Y â†’ X  ; mapping function</p>
</blockquote>
<h4><strong>cycle consistency loss</strong></h4>
<p>$F(G(X)) \approx X$</p>
<p>$x â†’ G(x) â†’ F(G(x)) \approx x$</p>
<p>$y â†’ F(y) â†’ G(F(y)) \approx y$</p>
<p>Unparied dataë¡œë„ í•™ìŠµì´ ê°€ëŠ¥í•´ì¡Œë‹¤, ë³„ë„ì˜ labelì´ ì—†ë‹¤â†’ <strong>unsupervised learning</strong></p>
<h4><strong>Full objective function (Loss)</strong></h4>
<p>$L(G,F,D_X,D_Y) = L_{GAN}(G,D_Y,X,Y) + L_{GAN}(F,D_X,Y,X) + \lambda L_{CYC}(G,F)$</p>
<p>ê·¸ëŸ¬ë‚˜ $L_{GAN} (G,D_Y,X,Y) = \mathbb E_{y~p_{data(y)}}[logD_Y(y)] + \mathbb E_{x~p_{data(x)}}[log(1-D_Y(G(x))]$ ë¥¼ ë³´ë©´</p>
<p>ë‘ê°œì˜ Domain ì‚¬ì´ì—ì„œ transferë¥¼ í•˜ë ¤ë©´ Discriminator ë‘ê°œì™€ Generator ë‘ê°œê°€ í•„ìš”í•œ ê²ƒì„ ë³¼ ìˆ˜ìˆë‹¤.</p>
<p>ì¦‰, ì´ë¥¼ <strong>ì—¬ëŸ¬ domain ì‚¬ì´ì—ì„œ transferë¥¼ í•˜ë ¤ë©´ Generatorì™€ Discriminator ì˜ ê°œìˆ˜ê°€ ë” ë§ì•„ì§„ë‹¤</strong>.</p>
<p>â‡’ ì—¬ê¸°ì„œ <strong>StarGANì´ ë“±ì¥</strong>í•œë‹¤.</p>
<h3>â­ <strong>StarGAN</strong></h3>
<img src="/images/gan_stylegan/02.png" style="width:400px;">
ìœ„ì—ì„œ ì§€ì í•œë°”ì™€ ê°™ì´ ìš°ë¦¬ê°€ ì—¬ëŸ¬ ìŠ¤íƒ€ì¼ë¡œ transferë¥¼ í•˜ê³  ì‹¶ì„ ë•Œ ê·¸ê±°ì— ë§ê²Œ ì„œë¡œë¥¼ ì—°ê²°í•´ì¤„ generatorì™€ discriminatorê°€ í•„ìš”í•œë° starganì—ì„œëŠ” ì´ë¥¼ í•˜ë‚˜ë¡œ ì²˜ë¦¬í•œë‹¤.

<p><img src="/images/gan_stylegan/03.png" alt="Untitled"></p>
<p>êµ¬ë¶„ì„ ì„ ê¸°ì¤€ìœ¼ë¡œ ì™¼ìª½(a)ì€ Discriminator, ì˜¤ë¥¸ìª½(b,c,d)ì€ Generatorì— ëŒ€í•œ ì„¤ëª…ì´ë‹¤. </p>
<p>main ideaëŠ” <strong>Domain classification</strong>ì„ ë„ì…í•´ í•˜ë‚˜ì˜ Generatorì™€ Discriminatorë¥¼ ì‚¬ìš©í•´ domainê°„ transferê°€ ê°€ëŠ¥í•˜ê²Œ í–ˆë‹¤ëŠ” ê²ƒì´ë‹¤. </p>
<p>**DiscriminatorëŠ” Real Imageë§Œì„ ì´ìš©í•´(not use Fake) Domain classificationì„ í•™ìŠµ (â†’ classification with real image)**í•˜ê³ , ë§ˆì°¬ê°€ì§€ë¡œ Realê³¼ Fakeë¥¼ êµ¬ë¶„í•  ìˆ˜ìˆë„ë¡ í•™ìŠµí•œë‹¤.</p>
<p><strong>Generator</strong>ëŠ” CycleGANì˜ ì•„ì´ë””ì–´ì™€ ìœ ì‚¬í•œë°, target domain labelê³¼ imageë¥¼ inputìœ¼ë¡œ ë°›ê³  fakeì´ë¯¸ì§€ë¥¼ ìƒì„±í•œë‹¤. (b)</p>
<p>ì´ë¥¼ ë‹¤ì‹œ Original domain labelê³¼ í•¨ê»˜ Generatorì— ë„£ì–´ì„œ imageë¥¼ reconstructí•œë‹¤. **ì´ reconstructed imageê°€ ìš°ë¦¬ê°€ ì²˜ìŒ inputìœ¼ë¡œ ë„£ì—ˆë˜ original imageê°€ ë˜ë„ë¡ í•™ìŠµ (â†’ Reconstruction loss)**ì‹œí‚¨ë‹¤. (c)</p>
<p>ê·¸ë¦¬ê³  ë§ˆì°¬ê°€ì§€ë¡œ Dë¥¼ ì†ì´ë„ë¡ í•™ìŠµí•œë‹¤.ì£¼ëª©í•  ì ì€ **Gê°€ Dë¥¼ fake imageì˜ domainê¹Œì§€ ì¶”ê°€ë¡œ ì†ì—¬ì•¼í•œë‹¤ (â†’ classfication with fake image)**ëŠ” ì ì´ë‹¤.(d)</p>
<h3>ğŸ¯ StyleGAN</h3>
<p><img src="/images/gan_stylegan/04.png" alt="Untitled"></p>
<p>ê¸°ì¡´ì—” fixed distributionì—ì„œ latent codeë¥¼ ë½‘ì•„ ë°”ë¡œ Generatorì— ë„£ì–´ ì£¼ì—ˆëŠ”ë° ì´ëŠ” literally black box ì˜€ë‹¤. StyleGANì—ì„œëŠ” mapping network, AdaIN, Noiseë¥¼ ë„ì…í•´ ì´ë¥¼ ì–´ëŠì •ë„ í•´ì†Œí–ˆë‹¤.</p>
<p><img src="/images/gan_stylegan/05.png" alt="Untitled"></p>
<ol>
<li><strong>Mapping Network</strong></li>
</ol>
<p>latent codeë¥¼ randomí•˜ê²Œ fixed distributionì—ì„œ ë½‘ì•„ Gì— ë„˜ê²¨ì£¼ëŠ”ê²Œ ê¸°ì¡´ë°©ì‹</p>
<p>StyleGANì—ì„  mapping networkë¥¼ ë„ì…í•´ zë¥¼ wë¡œ ë¨¼ì € mappingí•œ í›„ Gì— ë„£ì–´ì¤€ë‹¤</p>
<p>$$f : z â†’ w $$</p>
<p>ì´ë ‡ê²Œ ë¨ìœ¼ë¡œì¨ entanglementë¥¼ â€œì–´ëŠì •ë„â€ <strong>disentangle</strong>í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.</p>
<p>ë˜í•œ wë¥¼ Gì˜ input layerì— ë°”ë¡œ ë„£ì–´ì£¼ëŠ”ê²Œ ì•„ë‹ˆë¼ ê° layerì— ë„£ì–´ì£¼ë©´ì„œ style ì •ë³´ë„ ìš°ë¦¬ê°€ ì–´ëŠì •ë„ ì•Œ ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.</p>
<p><img src="/images/gan_stylegan/06.png" alt="Untitled"></p>
<ol start="2">
<li><strong>ProgressiveGAN based</strong></li>
</ol>
<p>ì‰½ê²Œ ë§í•´ ë‚®ì€ resolutionë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë§Œë“¤ì–´ê°„ë‹¤ëŠ” ê²ƒì´ë‹¤. ì—¬ê¸°ì„œ ìš°ë¦¬ê°€ ì£¼ëª©í•´ì•¼ ë ê²ƒì€</p>
<p><strong>ë‚®ì€ Resolutionì—ì„œëŠ” ì¡°ê¸ˆ ë” globalí•œ, coarseí•œ, macroscopicí•œ featureë“¤ê³¼ ê´€ë ¨ë˜ê³ </strong></p>
<p><strong>ë†’ì€ Resolutionì—ì„œëŠ” ì¡°ê¸ˆ ë” localí•œ, fineí•œ, microscopicí•œ featureë“¤ê³¼ ê´€ë ¨ëœë‹¤ëŠ” ê²ƒì´ë‹¤.</strong>
<img src="/images/gan_stylegan/07.png" alt="Untitled"></p>
<ol start="3">
<li><strong>AdaIN + Noise</strong></li>
</ol>
<p><strong>AdaINì€</strong> featureë¥¼ normalizeí•˜ê³  ìŠ¤íƒ€ì¼ì— ê´€í•œ ì •ë³´ë¡œ ìŠ¤ì¼€ì¼ë§í•˜ëŠ” ì—­í• ì„ í•œë‹¤. ì¦‰ feature ì •ë³´ëŠ” ë‚¨ê¸°ë˜ ê¸°ì¡´ì˜ statisticsì— ê´€í•œ ì •ë³´ë¥¼ ì§€ìš°ê³  styleì— ê¸°ë°˜í•œ ìƒˆë¡œìš´ statisticsì„ ë”°ë¥´ê²Œ í•œë‹¤.( AdaINì„ í•´ì£¼ê³  ë‹¤ìŒ AdaInì„ í•´ì£¼ê¸° ì „ê¹Œì§€ ê°™ì€ ë¶„í¬, ì˜ì—­ë³„ë¡œ ë”°ë¥´ëŠ” ë¶„í¬ê°€ ë‹¤ë¦„, feature ì •ë³´ëŠ” ìœ ì§€í•´ì„œ ë„˜ê²¨ì¤Œ).
<img src="/images/gan_stylegan/08.png" alt="Untitled"></p>
<aside>
ì›ë˜ ìˆë˜ feature mapì˜ scale íŠ¹ì§•ì„ ìƒˆë¡œìš´ ê°’ìœ¼ë¡œ ë°”ê¿ˆ (ìƒˆë¡œìš´ style ì¶”ê°€)
> í•œ layerì—ì„œ ì…í˜€ì§„ styleì€ ë‹¤ìŒ convolution layerì—ë§Œ ì˜í–¥, ë‹¤ìŒ blockì—ëŠ” ì˜í–¥ X
> Progressive êµ¬ì¡°ì™€ í•©ì³ì ¸ì„œ style ë§ˆë‹¤ global / local íŠ¹ì§• ê°–ê²Œ ë¨
</aside>

<p>ë‹¤ìŒ convolution ì— ë” ì¤‘ìš”í•œ ì •ë³´ë¥¼ ë„˜ê²¨ì£¼ëŠ” ì—­í• ë¡œ ì´í•´í•  ìˆ˜ ìˆë‹¤ â†’ <strong>Styleì„ ë”í•´ì¤€ë‹¤!</strong>
<img src="/images/gan_stylegan/09.png" alt="Untitled">
<strong>Noiseë¥¼ ì£¼ë©´ì„œ ì¡°ê¸ˆ ë” detailí•˜ê³  localí•œ ì •ë³´ë“¤ì„ ì •êµí•˜ê²Œ ìƒì„±í•  ìˆ˜ ìˆë‹¤.</strong></p>
<p><img src="/images/gan_stylegan/10.png" alt="Untitled"></p>
<h3>Style Mixing</h3>
<p>ì´ Style Mixingì€ ìš°ë¦¬ í”„ë¡œì íŠ¸ë‘ ë°€ì ‘í•œ ê´€ë ¨ì´ ìˆë‹¤. Style Mixingì´ ê°€ëŠ¥í•˜ê³ , ì–´ë–¤ ì›ë¦¬ì— ì˜í•´ ë˜ëŠ”ì§€ ì´í•´í•´ì•¼í•œë‹¤.</p>
<p><img src="/images/gan_stylegan/11.png" alt="Untitled"></p>
<aside>

<h3>ğŸ”„â€¯ <strong>Style Mixing</strong></h3>
<p>: $w_1$, $w_2$ ë¥¼ ì„ì–´ì„œ ì´ë¯¸ì§€ ìƒì„±
: ì„ì„ ë•Œ ì–´ë–¤ layerì— ë¬´ì—‡ì„ ë„£ëŠ”ì§€ë¥¼ ë³€ê²½í•˜ë©° ì‹¤í—˜í•œ ê²°ê³¼</p>
</aside>
mapping networkë¥¼ í†µê³¼í•œ w, ì¦‰ style(y = W * **w** +b, styleì€ ë‹¨ìˆœíˆ wë¥¼ affine transformí•œ ê²°ê³¼ì´ë¯€ë¡œ)ê³¼ ê´€ë ¨ëœ ë‘ ë²¡í„°(w1,w2)ë¥¼ ë¯¹ì‹±í•œ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤. 

<p>â‡’ low resolution levelì€ pose, identity, general hair-style, face-shape, eye-glasses ê°™ì€ coarse(global,macroscope)í•œ íŠ¹ì§•ë“¤ê³¼ ê´€ë ¨ìˆê³ ,</p>
<p>high resolutionìœ¼ë¡œ ê°ˆ ìˆ˜ë¡ color ê°™ì´ ë” fine(local,microscope)í•œ íŠ¹ì§•ë“¤ê³¼ ê´€ë ¨ì´ ìˆìŒì„ ë³¼ ìˆ˜ ìˆì—ˆë‹¤. (â†’ ìš°ë¦¬ê°€ controlí•  ì—¬ì§€ê°€ ë³´ì¸ë‹¤â€¦!)</p>
<aside>

<p><strong>StyleGAN2 ëŠ” ê°€ì ¸ë‹¤ ì‚¬ìš©í•˜ë©´ ë  ê±°ê³  ìš°ë¦¬ í”Œì ì— ì‚¬ìš©í•  ì¤‘ìš”í•œ ì›ë¦¬ëŠ” StyleGAN1ì— ìˆë‹¤</strong></p>
<p>v1ì—ì„œ AdaIN í•  ë•Œ normalizeì™€ modulationí•˜ëŠ” ê³¼ì •ì—ì„œ ë¬¸ì œê°€ ìˆì–´ì„œ effectëŠ” ìœ ì§€í•˜ë˜ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ styleì„ ë”í•´ì£¼ëŠ” ê³¼ì •ì„ ì§„í–‰í•¨</p>
</aside>




<h3>ğŸ–¼ï¸ <strong>Toonify</strong></h3>
<p><img src="/images/gan_stylegan/12.png" alt="Untitled"></p>
<p>StyleGANì„ baseë¡œ ì‚¼ê³ ìˆë‹¤.</p>
<p>ìš°ë¦¬ê°€ ì„ íƒí•œ íŠ¹ì • Resolutionì„ ê¸°ì¤€ìœ¼ë¡œ layer block ì˜ì—­ì„ ë‘ê°œ(ë‚®ì€ í•´ìƒë„, ë†’ì€ í•´ìƒë„)ë¡œ ë‚˜ëˆˆë‹¤. í•˜ë‚˜ì˜ ì˜ì—­ì—ëŠ” base modelì˜ weightë¥¼, ë‹¤ë¥¸ ì˜ì—­ì—ëŠ” trasnfer learned modelì˜ weightë¥¼ ì‚¬ìš©í•œë‹¤. ì´ ë…¼ë¬¸ì€ StyleGAN Style Mixingì„ ì´í•´í•˜ë©´ ì‰½ê²Œ ë‚©ë“ ê°€ëŠ¥í•˜ë‹¤.</p>
<h3>ğŸª <strong>GAN Inversion</strong></h3>
<p>ê°€ì¥ ê¶ê¸ˆí–ˆë˜ ë¶€ë¶„ì´ í•´ê²°ëœ ì§€ì ì´ë‹¤. GANì—ëŠ” ì–´ë–¤ distribution(ex. Gaussian)ì—ì„œ randomí•˜ê²Œ latent codeë½‘ì•„ Generatorì— ë„£ì–´ì¤¬ëŠ”ë°, ê·¸ëŸ¬ë©´ ë„ëŒ€ì²´ imageë¥¼ inputìœ¼ë¡œí•´ì„œ ì–´ë–»ê²Œ styleì„ ë°”ê¾¸ëŠ” ê±¸ê¹Œ? ì—ëŒ€í•œ ë‹µì„ ì£¼ì—ˆë‹¤.</p>
<p>Gê°€ ì–´ë–¤ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•´ ëƒˆì„ ë•Œ, ì´ <strong>ì´ë¯¸ì§€ì— ëŒ€í•œ latent vectorë¥¼ ì°¾ëŠ”</strong>â€¦ ê·¸ë˜ì„œ inversionâ€¦ WOWâ€¦</p>
<p>ìš°ë¦¬ í”„ë¡œì íŠ¸ì— ê°€ì¥ ì¤‘ìš”í•œ Subtaskê°€ ë  ê²ƒ ê°™ë‹¤. â‡’ <strong>GAN Inversion</strong> </p>
<p><img src="/images/gan_stylegan/13.png" alt="Untitled"></p>
<blockquote>
<p>latent code -&gt; image (X)
image -&gt; latent code (O)</p>
</blockquote>
<p><img src="/images/gan_stylegan/14.png" alt="Untitled"></p>
<blockquote>
<p>find $w$</p>
</blockquote>
<p>ğŸ“â€¯ì •ë¦¬í•˜ë©´</p>
<p>StyleGANì˜ MappingÂ Networkë¡œ ì ì¬ ì†ì„±ì„ ë¶„ë¦¬í•´ ìŠ¤íƒ€ì¼ ì œì–´ê°€ ìš©ì´í•˜ë‹¤.</p>
<p>AdaINÂ +Â Noiseê°€ ì „ì—­Â·êµ­ì†Œ ìŠ¤íƒ€ì¼ì„ ì¸µë³„ë¡œ ë¶„ë‹´í•œë‹¤.</p>
<p>StyleÂ Mixingì€ ì›í•˜ëŠ” ë ˆì´ì–´ì—ì„œ ë‘ ìŠ¤íƒ€ì¼ì„ í˜¼í•©, ì„¸ë°€í•œ ì»¨íŠ¸ë¡¤ì„ ê°€ëŠ¥ì¼€ í•œë‹¤.</p>
<p>GANÂ Inversionì„ ì´ìš©í•˜ë©´ ì„ì˜ì˜ ì´ë¯¸ì§€ë„ StyleGANÂ íŒŒì´í”„ë¼ì¸ ì•ˆì—ì„œ ììœ ë¡­ê²Œ í¸ì§‘í•  ìˆ˜ ìˆë‹¤.</p>

    <section class="related">
        <div class="related-head">
          <h2>Related posts</h2>
          <a class="all-link" href="../../">Browse all articles&nbsp;â†’</a>
        </div>
        <div class="related-list">
      <a class="card mini" href="../../posts/difussion_latent_diffusion/">
        <img class="thumb" src="../..//images/difussion_latent_diffusion/thumbnail.png" alt="">
        <div class="card-body">
        
          <h3 class="card-title">Difussion : Latent Diffusion</h3>
          <span class="arrow">â†—</span>
          <div class="meta">Feb 7, 2023 Â· 20 min</div>
        </div>
      </a>
      <a class="card mini" href="../../posts/Diffusion_DDIM/">
        <img class="thumb" src="../../images/diffusion_ddim/thumbnail.png" alt="">
        <div class="card-body">
        
          <h3 class="card-title">Diffusion : DDIM</h3>
          <span class="arrow">â†—</span>
          <div class="meta">Jan 31, 2023 Â· 20 min</div>
        </div>
      </a>
      <a class="card mini" href="../../posts/Diffusion_DDPM/">
        <img class="thumb" src="../..//images/diffusion_ddpm/thumbnail.jpg" alt="">
        <div class="card-body">
        
          <h3 class="card-title">Diffusion : DDPM</h3>
          <span class="arrow">â†—</span>
          <div class="meta">Jan 22, 2023 Â· 20 min</div>
        </div>
      </a></div>
      </section> 
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
<script>
window.MathJax = {
  tex: {
    inlineMath:  [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    processEnvironments: true
  },

  chtml: {
    linebreaks: { automatic: true, width: "match" }  // ë˜ëŠ” width: 80
  },

  options: {
    renderActions: { addMenu: [] }   // ìš°í´ë¦­ ë©”ë‰´ ì œê±°
  }
};
</script>
<script id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <script src="../../assets/js/main.js" defer></script>
</body></html>